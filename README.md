# Learn with Jiji ‚Äì Backend Assignment

This repository contains the backend implementation for **Learn with Jiji**, an AI learning companion by VeidaLabs.  
The backend powers a simple **search & respond flow** using Supabase for database, authentication, storage, and security.

---

## üõ† Tech Stack

- **Node.js**
- **Express.js**
- **Supabase**
  - Database (PostgreSQL)
  - Authentication
  - Storage
  - Row Level Security (RLS)

---


### 1. Clone the Repository
git clone (https://github.com/vinayrajput21/jiji-backend-task.git)

## üöÄ How to Run the Project
cd jiji-backend-task
npm i 
npm run dev 


### API endpoint

### **POST** `/api/askjiji`

Ask Jiji a question.

**Headers:**
```
Authorization: Bearer <access_token>

```
### Request Body--->
```
{
  "query": "Explain RAG"
}
```

### **POST** `/api/token`

### Request Body
```
{
"email": "YOUR_EMAIL",
"password":"YOUR_PASS"
}
```
Use this api for token generation you can copy the token and use ti further in the header as bearer token 



## How Auth and RLS work 

Generate Token: Call /api/token to receive an access token
Authenticate Requests: Include the token in the Authorization header as Bearer <access_token>
Row Level Security: All database queries are protected by Supabase RLS policies - requests without valid authentication will be rejected

## One improvement you‚Äôd make with more time

Integrate LLM API (e.g., Google Gemini) to process queries and generate intelligent responses
Build Frontend Interface as specified in the assignment PDF for a complete user experience

## üóÑÔ∏è Database Schema

The project uses **Supabase (PostgreSQL)**. Below is the structure of the database tables:

### 1. `profiles`
Stores extended user information linked to Supabase Auth.
| Column | Type | Notes |
| :--- | :--- | :--- |
| `id` | `uuid` | Primary Key (References `auth.users`) |
| `name` | `text` | User's full name |
| `email` | `text` | User's email address |
| `created_at` | `timestamp` | Defaults to current time |

### 2. `queries`
Stores search or interaction history generated by users.
| Column | Type | Notes |
| :--- | :--- | :--- |
| `id` | `uuid` | Primary Key (Random UUID) |
| `user_id` | `uuid` | Foreign Key (References `auth.users`) |
| `query_text` | `text` | The content of the query (Required) |
| `created_at` | `timestamp` | Defaults to current time |

### 3. `resources`
Stores metadata for uploaded materials (PPTs/Videos).
| Column | Type | Notes |
| :--- | :--- | :--- |
| `id` | `uuid` | Primary Key (Random UUID) |
| `title` | `text` | Title of the resource |
| `type` | `text` | Restricted to `'ppt'` or `'video'` |
| `storage_url` | `text` | URL to the file in Supabase Storage |
| `tags` | `text[]` | Array of strings for categorization |
| `created_at` | `timestamp` | Defaults to current time |

---

## üõ†Ô∏è SQL Migration Reference
To set up this database locally or in a new Supabase project, run the following SQL:

```sql
-- Create Profiles
create table profiles (
  id uuid references auth.users on delete cascade,
  name text,
  email text,
  created_at timestamp default now(),
  primary key (id)
);

-- Create Queries
create table queries (
  id uuid default gen_random_uuid() primary key,
  user_id uuid references auth.users,
  query_text text not null,
  created_at timestamp default now()
);

-- Create Resources
create table resources (
  id uuid default gen_random_uuid() primary key,
  title text not null,
  type text check (type in ('ppt', 'video')),
  storage_url text not null,
  tags text[],
  created_at timestamp default now()
);